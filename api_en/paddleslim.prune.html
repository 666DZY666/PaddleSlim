

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>paddleslim.prune package &mdash; PaddleSlim 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PaddleSlim 1.0 documentation" href="../index.html"/>
        <link rel="up" title="API Documents" href="index_en.html"/>
        <link rel="next" title="paddleslim.dist package" href="paddleslim.dist.html"/>
        <link rel="prev" title="paddleslim.analysis package" href="paddleslim.analysis.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index_en.html" class="icon icon-home"> PaddleSlim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">中文文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro_en.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install_en.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/index_en.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index_en.html">Aadvanced Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index_en.html">API Documents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="paddleslim.analysis.html">paddleslim.analysis package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">paddleslim.prune package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-paddleslim.prune.auto_pruner">paddleslim.prune.auto_pruner module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-paddleslim.prune.prune_io">paddleslim.prune.prune_io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-paddleslim.prune.prune_walker">paddleslim.prune.prune_walker module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-paddleslim.prune.pruner">paddleslim.prune.pruner module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-paddleslim.prune.sensitive">paddleslim.prune.sensitive module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-paddleslim.prune.sensitive_pruner">paddleslim.prune.sensitive_pruner module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="paddleslim.dist.html">paddleslim.dist package</a></li>
<li class="toctree-l2"><a class="reference internal" href="paddleslim.quant.html">paddleslim.quant package</a></li>
<li class="toctree-l2"><a class="reference internal" href="paddleslim.nas.html">paddleslim.nas package</a></li>
<li class="toctree-l2"><a class="reference internal" href="paddleslim.nas.one_shot.html">paddleslim.nas.one_shot package</a></li>
<li class="toctree-l2"><a class="reference internal" href="paddleslim.pantheon.html">paddleslim.pantheon package</a></li>
<li class="toctree-l2"><a class="reference internal" href="search_space_en.html">search space</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../model_zoo_en.html">Model Zoo</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index_en.html">PaddleSlim</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index_en.html">Docs</a> &raquo;</li>
      
          <li><a href="index_en.html">API Documents</a> &raquo;</li>
      
    <li>paddleslim.prune package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api_en/paddleslim.prune.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-paddleslim.prune">
<span id="paddleslim-prune-package"></span><h1>paddleslim.prune package<a class="headerlink" href="#module-paddleslim.prune" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="paddleslim.prune.Pruner">
<em class="property">class </em><code class="descclassname">paddleslim.prune.</code><code class="descname">Pruner</code><span class="sig-paren">(</span><em>criterion='l1_norm'</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.Pruner" title="Permalink to this definition">¶</a></dt>
<dd><p>The pruner used to prune channels of convolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>criterion</strong> (<em>str</em>) &#8211; the criterion used to sort channels for pruning. It only supports &#8216;l1_norm&#8217; currently.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="paddleslim.prune.Pruner.prune">
<code class="descname">prune</code><span class="sig-paren">(</span><em>program</em>, <em>scope</em>, <em>params</em>, <em>ratios</em>, <em>place=None</em>, <em>lazy=False</em>, <em>only_graph=False</em>, <em>param_backup=False</em>, <em>param_shape_backup=False</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.Pruner.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Pruning the given parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>program</strong> (<em>fluid.Program</em>) &#8211; The program to be pruned.</li>
<li><strong>scope</strong> (<em>fluid.Scope</em>) &#8211; The scope storing paramaters to be pruned.</li>
<li><strong>params</strong> (<em>list&lt;str&gt;</em>) &#8211; A list of parameter names to be pruned.</li>
<li><strong>ratios</strong> (<em>list&lt;float&gt;</em>) &#8211; A list of ratios to be used to pruning parameters.</li>
<li><strong>place</strong> (<em>fluid.Place</em>) &#8211; The device place of filter parameters. Defalut: None.</li>
<li><strong>lazy</strong> (<em>bool</em>) &#8211; True means setting the pruned elements to zero.
False means cutting down the pruned elements. Default: False.</li>
<li><strong>only_graph</strong> (<em>bool</em>) &#8211; True means only modifying the graph.
False means modifying graph and variables in scope. Default: False.</li>
<li><strong>param_backup</strong> (<em>bool</em>) &#8211; Whether to return a dict to backup the values of parameters. Default: False.</li>
<li><strong>param_shape_backup</strong> (<em>bool</em>) &#8211; Whether to return a dict to backup the shapes of parameters. Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">(pruned_program,</span> <span class="pre">param_backup,</span> <span class="pre">param_shape_backup)</span></code>. <code class="docutils literal"><span class="pre">pruned_program</span></code> is the pruned program. <code class="docutils literal"><span class="pre">param_backup</span></code> is a dict to backup the values of parameters. <code class="docutils literal"><span class="pre">param_shape_backup</span></code> is a dict to backup the shapes of parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="paddleslim.prune.AutoPruner">
<em class="property">class </em><code class="descclassname">paddleslim.prune.</code><code class="descname">AutoPruner</code><span class="sig-paren">(</span><em>program, scope, place, params=[], init_ratios=None, pruned_flops=0.5, pruned_latency=None, server_addr=('', 0), init_temperature=100, reduce_rate=0.85, max_try_times=300, max_client_num=10, search_steps=300, max_ratios=[0.9], min_ratios=[0], key='auto_pruner', is_server=True</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.AutoPruner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Search a group of ratios used to prune program.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>program</strong> (<em>Program</em>) &#8211; The program to be pruned.</li>
<li><strong>scope</strong> (<em>Scope</em>) &#8211; The scope to be pruned.</li>
<li><strong>place</strong> (<em>fluid.Place</em>) &#8211; The device place of parameters.</li>
<li><strong>params</strong> (<em>list&lt;str&gt;</em>) &#8211; The names of parameters to be pruned.</li>
<li><strong>init_ratios</strong> (<em>list&lt;float&gt;|float</em>) &#8211; Init ratios used to pruned parameters in <cite>params</cite>.
List means ratios used for pruning each parameter in <cite>params</cite>.
The length of <cite>init_ratios</cite> should be equal to length of params when <cite>init_ratios</cite> is a list.
If it is a scalar, all the parameters in <cite>params</cite> will be pruned by uniform ratio.
None means get a group of init ratios by <cite>pruned_flops</cite> of <cite>pruned_latency</cite>. Default: None.</li>
<li><strong>pruned_flops</strong> (<em>float</em>) &#8211; The percent of FLOPS to be pruned. Default: None.</li>
<li><strong>pruned_latency</strong> (<em>float</em>) &#8211; The percent of latency to be pruned. Default: None.</li>
<li><strong>server_addr</strong> (<em>tuple</em>) &#8211; A tuple of server ip and server port for controller server.</li>
<li><strong>init_temperature</strong> (<em>float</em>) &#8211; The init temperature used in simulated annealing search strategy.</li>
<li><strong>reduce_rate</strong> (<em>float</em>) &#8211; The decay rate used in simulated annealing search strategy.</li>
<li><strong>max_try_times</strong> (<em>int</em>) &#8211; The max number of trying to generate legal tokens.</li>
<li><strong>max_client_num</strong> (<em>int</em>) &#8211; The max number of connections of controller server.</li>
<li><strong>search_steps</strong> (<em>int</em>) &#8211; The steps of searching.</li>
<li><strong>max_ratios</strong> (<em>float|list&lt;float&gt;</em>) &#8211; Max ratios used to pruned parameters in <cite>params</cite>.
List means max ratios for each parameter in <cite>params</cite>.
The length of <cite>max_ratios</cite> should be equal to length of params when <cite>max_ratios</cite> is a list.
If it is a scalar, it will used for all the parameters in <cite>params</cite>.</li>
<li><strong>min_ratios</strong> (<em>float|list&lt;float&gt;</em>) &#8211; Min ratios used to pruned parameters in <cite>params</cite>.
List means min ratios for each parameter in <cite>params</cite>.
The length of <cite>min_ratios</cite> should be equal to length of params when <cite>min_ratios</cite> is a list.
If it is a scalar, it will used for all the parameters in <cite>params</cite>.</li>
<li><strong>key</strong> (<em>str</em>) &#8211; Identity used in communication between controller server and clients.</li>
<li><strong>is_server</strong> (<em>bool</em>) &#8211; Whether current host is controller server. Default: True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="paddleslim.prune.AutoPruner.prune">
<code class="descname">prune</code><span class="sig-paren">(</span><em>program</em>, <em>eval_program=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.AutoPruner.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune program with latest tokens generated by controller.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>program</strong> (<em>fluid.Program</em>) &#8211; The program to be pruned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The pruned program.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">paddle.fluid.Program</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="paddleslim.prune.AutoPruner.reward">
<code class="descname">reward</code><span class="sig-paren">(</span><em>score</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.AutoPruner.reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Return reward of current pruned program.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>float</strong> &#8211; The score of pruned program.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="paddleslim.prune.SensitivePruner">
<em class="property">class </em><code class="descclassname">paddleslim.prune.</code><code class="descname">SensitivePruner</code><span class="sig-paren">(</span><em>place</em>, <em>eval_func</em>, <em>scope=None</em>, <em>checkpoints=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.SensitivePruner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Pruner used to prune parameters iteratively according to sensitivities
of parameters in each step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>place</strong> (<em>fluid.CUDAPlace | fluid.CPUPlace</em>) &#8211; The device place where
program execute.</li>
<li><strong>eval_func</strong> (<em>function</em>) &#8211; A callback function used to evaluate pruned
program. The argument of this function is pruned program.
And it return a score of given program.</li>
<li><strong>scope</strong> (<em>fluid.scope</em>) &#8211; The scope used to execute program.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="paddleslim.prune.SensitivePruner.get_ratios_by_sensitive">
<code class="descname">get_ratios_by_sensitive</code><span class="sig-paren">(</span><em>sensitivities</em>, <em>pruned_flops</em>, <em>eval_program</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.SensitivePruner.get_ratios_by_sensitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Search a group of ratios for pruning target flops.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sensitivities</strong> (<em>dict</em>) &#8211; The sensitivities used to generate a group of pruning ratios. The key of dict
is name of parameters to be pruned. The value of dict is a list of tuple with
format <cite>(pruned_ratio, accuracy_loss)</cite>.</li>
<li><strong>pruned_flops</strong> (<em>float</em>) &#8211; The percent of FLOPS to be pruned.</li>
<li><strong>eval_program</strong> (<em>Program</em>) &#8211; The program whose FLOPS is considered.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A group of ratios. The key of dict is name of parameters while the value is the ratio to be pruned.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="paddleslim.prune.SensitivePruner.greedy_prune">
<code class="descname">greedy_prune</code><span class="sig-paren">(</span><em>train_program</em>, <em>eval_program</em>, <em>params</em>, <em>pruned_flops_rate</em>, <em>topk=1</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.SensitivePruner.greedy_prune" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="paddleslim.prune.SensitivePruner.prune">
<code class="descname">prune</code><span class="sig-paren">(</span><em>train_program</em>, <em>eval_program</em>, <em>params</em>, <em>pruned_flops</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.SensitivePruner.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Pruning parameters of training and evaluation network by sensitivities in current step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>train_program</strong> (<em>fluid.Program</em>) &#8211; The training program to be pruned.</li>
<li><strong>eval_program</strong> (<em>fluid.Program</em>) &#8211; The evaluation program to be pruned. And it is also used to calculate sensitivities of parameters.</li>
<li><strong>params</strong> (<em>list&lt;str&gt;</em>) &#8211; The parameters to be pruned.</li>
<li><strong>pruned_flops</strong> (<em>float</em>) &#8211; The ratio of FLOPS to be pruned in current step.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tuple of pruned training program and pruned evaluation program.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="paddleslim.prune.SensitivePruner.restore">
<code class="descname">restore</code><span class="sig-paren">(</span><em>checkpoints=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.SensitivePruner.restore" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="paddleslim.prune.SensitivePruner.save_checkpoint">
<code class="descname">save_checkpoint</code><span class="sig-paren">(</span><em>train_program</em>, <em>eval_program</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.SensitivePruner.save_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.sensitivity">
<code class="descclassname">paddleslim.prune.</code><code class="descname">sensitivity</code><span class="sig-paren">(</span><em>program</em>, <em>place</em>, <em>param_names</em>, <em>eval_func</em>, <em>sensitivities_file=None</em>, <em>pruned_ratios=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sensitivities of convolutions in a model. The sensitivity of a convolution is the losses of accuracy on test dataset in differenct pruned ratios. The sensitivities can be used to get a group of best ratios with some condition.
This function return a dict storing sensitivities as below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;weight_0&quot;</span><span class="p">:</span>
    <span class="p">{</span><span class="mf">0.1</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">,</span>
     <span class="mf">0.2</span><span class="p">:</span> <span class="mf">0.33</span>
    <span class="p">},</span>
  <span class="s2">&quot;weight_1&quot;</span><span class="p">:</span>
    <span class="p">{</span><span class="mf">0.1</span><span class="p">:</span> <span class="mf">0.21</span><span class="p">,</span>
     <span class="mf">0.2</span><span class="p">:</span> <span class="mf">0.4</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">weight_0</span></code> is parameter name of convolution. <code class="docutils literal"><span class="pre">sensitivities['weight_0']</span></code> is a dict in which key is pruned ratio and value is the percent of losses.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>program</strong> (<em>paddle.fluid.Program</em>) &#8211; The program to be analysised.</li>
<li><strong>place</strong> (<em>fluid.CPUPlace | fluid.CUDAPlace</em>) &#8211; The device place of filter parameters.</li>
<li><strong>param_names</strong> (<em>list</em>) &#8211; The parameter names of convolutions to be analysised.</li>
<li><strong>eval_func</strong> (<em>function</em>) &#8211; The callback function used to evaluate the model. It should accept a instance of <cite>paddle.fluid.Program</cite> as argument and return a score on test dataset.</li>
<li><strong>sensitivities_file</strong> (<em>str</em>) &#8211; The file to save the sensitivities. It will append the latest computed sensitivities into the file. And the sensitivities in the file would not be computed again. This file can be loaded by <cite>pickle</cite> library.</li>
<li><strong>pruned_ratios</strong> (<em>list</em>) &#8211; The ratios to be pruned. default: <code class="docutils literal"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8,</span> <span class="pre">0.9]</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A dict storing sensitivities.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.flops_sensitivity">
<code class="descclassname">paddleslim.prune.</code><code class="descname">flops_sensitivity</code><span class="sig-paren">(</span><em>program</em>, <em>place</em>, <em>param_names</em>, <em>eval_func</em>, <em>sensitivities_file=None</em>, <em>pruned_flops_rate=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.flops_sensitivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="paddleslim.prune.load_sensitivities">
<code class="descclassname">paddleslim.prune.</code><code class="descname">load_sensitivities</code><span class="sig-paren">(</span><em>sensitivities_file</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.load_sensitivities" title="Permalink to this definition">¶</a></dt>
<dd><p>Load sensitivities from file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sensitivities_file</strong> (<em>str</em>) &#8211; The file storing sensitivities.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dict stroring sensitivities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.merge_sensitive">
<code class="descclassname">paddleslim.prune.</code><code class="descname">merge_sensitive</code><span class="sig-paren">(</span><em>sensitivities</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.merge_sensitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge sensitivities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sensitivities</strong> (<em>list&lt;dict&gt; | list&lt;str&gt;</em>) &#8211; The sensitivities to be merged. It cann be a list of sensitivities files or dict.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dict stroring sensitivities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.get_ratios_by_loss">
<code class="descclassname">paddleslim.prune.</code><code class="descname">get_ratios_by_loss</code><span class="sig-paren">(</span><em>sensitivities</em>, <em>loss</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.get_ratios_by_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the max ratio of each parameter. The loss of accuracy must be less than given <cite>loss</cite>
when the single parameter was pruned by the max ratio.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sensitivities</strong> (<em>dict</em>) &#8211; The sensitivities used to generate a group of pruning ratios. The key of dict
is name of parameters to be pruned. The value of dict is a list of tuple with
format <cite>(pruned_ratio, accuracy_loss)</cite>.</li>
<li><strong>loss</strong> (<em>float</em>) &#8211; The threshold of accuracy loss.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A group of ratios. The key of dict is name of parameters while the value is the ratio to be pruned.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="paddleslim.prune.conv2d">
<em class="property">class </em><code class="descclassname">paddleslim.prune.</code><code class="descname">conv2d</code><span class="sig-paren">(</span><em>op</em>, <em>pruned_params</em>, <em>visited={}</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.conv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">paddleslim.prune.prune_walker.PruneWorker</span></code></p>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.save_model">
<code class="descclassname">paddleslim.prune.</code><code class="descname">save_model</code><span class="sig-paren">(</span><em>exe</em>, <em>graph</em>, <em>dirname</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save weights of model and information of shapes into filesystem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>exe</strong> (<em>paddle.fluid.Executor</em>) &#8211; The executor used to save model.</li>
<li><strong>graph</strong> (<em>Program|Graph</em>) &#8211; The graph to be saved.</li>
<li><strong>dirname</strong> (<em>str</em>) &#8211; The directory that the model saved into.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.load_model">
<code class="descclassname">paddleslim.prune.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>exe</em>, <em>graph</em>, <em>dirname</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load weights of model and information of shapes from filesystem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graph</strong> (<em>Program|Graph</em>) &#8211; The graph to be updated by loaded information..</li>
<li><strong>dirname</strong> (<em>str</em>) &#8211; The directory that the model will be loaded.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-paddleslim.prune.auto_pruner">
<span id="paddleslim-prune-auto-pruner-module"></span><h2>paddleslim.prune.auto_pruner module<a class="headerlink" href="#module-paddleslim.prune.auto_pruner" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="paddleslim.prune.auto_pruner.AutoPruner">
<em class="property">class </em><code class="descclassname">paddleslim.prune.auto_pruner.</code><code class="descname">AutoPruner</code><span class="sig-paren">(</span><em>program, scope, place, params=[], init_ratios=None, pruned_flops=0.5, pruned_latency=None, server_addr=('', 0), init_temperature=100, reduce_rate=0.85, max_try_times=300, max_client_num=10, search_steps=300, max_ratios=[0.9], min_ratios=[0], key='auto_pruner', is_server=True</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.auto_pruner.AutoPruner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Search a group of ratios used to prune program.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>program</strong> (<em>Program</em>) &#8211; The program to be pruned.</li>
<li><strong>scope</strong> (<em>Scope</em>) &#8211; The scope to be pruned.</li>
<li><strong>place</strong> (<em>fluid.Place</em>) &#8211; The device place of parameters.</li>
<li><strong>params</strong> (<em>list&lt;str&gt;</em>) &#8211; The names of parameters to be pruned.</li>
<li><strong>init_ratios</strong> (<em>list&lt;float&gt;|float</em>) &#8211; Init ratios used to pruned parameters in <cite>params</cite>.
List means ratios used for pruning each parameter in <cite>params</cite>.
The length of <cite>init_ratios</cite> should be equal to length of params when <cite>init_ratios</cite> is a list.
If it is a scalar, all the parameters in <cite>params</cite> will be pruned by uniform ratio.
None means get a group of init ratios by <cite>pruned_flops</cite> of <cite>pruned_latency</cite>. Default: None.</li>
<li><strong>pruned_flops</strong> (<em>float</em>) &#8211; The percent of FLOPS to be pruned. Default: None.</li>
<li><strong>pruned_latency</strong> (<em>float</em>) &#8211; The percent of latency to be pruned. Default: None.</li>
<li><strong>server_addr</strong> (<em>tuple</em>) &#8211; A tuple of server ip and server port for controller server.</li>
<li><strong>init_temperature</strong> (<em>float</em>) &#8211; The init temperature used in simulated annealing search strategy.</li>
<li><strong>reduce_rate</strong> (<em>float</em>) &#8211; The decay rate used in simulated annealing search strategy.</li>
<li><strong>max_try_times</strong> (<em>int</em>) &#8211; The max number of trying to generate legal tokens.</li>
<li><strong>max_client_num</strong> (<em>int</em>) &#8211; The max number of connections of controller server.</li>
<li><strong>search_steps</strong> (<em>int</em>) &#8211; The steps of searching.</li>
<li><strong>max_ratios</strong> (<em>float|list&lt;float&gt;</em>) &#8211; Max ratios used to pruned parameters in <cite>params</cite>.
List means max ratios for each parameter in <cite>params</cite>.
The length of <cite>max_ratios</cite> should be equal to length of params when <cite>max_ratios</cite> is a list.
If it is a scalar, it will used for all the parameters in <cite>params</cite>.</li>
<li><strong>min_ratios</strong> (<em>float|list&lt;float&gt;</em>) &#8211; Min ratios used to pruned parameters in <cite>params</cite>.
List means min ratios for each parameter in <cite>params</cite>.
The length of <cite>min_ratios</cite> should be equal to length of params when <cite>min_ratios</cite> is a list.
If it is a scalar, it will used for all the parameters in <cite>params</cite>.</li>
<li><strong>key</strong> (<em>str</em>) &#8211; Identity used in communication between controller server and clients.</li>
<li><strong>is_server</strong> (<em>bool</em>) &#8211; Whether current host is controller server. Default: True.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="paddleslim.prune.auto_pruner.AutoPruner.prune">
<code class="descname">prune</code><span class="sig-paren">(</span><em>program</em>, <em>eval_program=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.auto_pruner.AutoPruner.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune program with latest tokens generated by controller.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>program</strong> (<em>fluid.Program</em>) &#8211; The program to be pruned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The pruned program.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">paddle.fluid.Program</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="paddleslim.prune.auto_pruner.AutoPruner.reward">
<code class="descname">reward</code><span class="sig-paren">(</span><em>score</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.auto_pruner.AutoPruner.reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Return reward of current pruned program.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>float</strong> &#8211; The score of pruned program.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-paddleslim.prune.prune_io">
<span id="paddleslim-prune-prune-io-module"></span><h2>paddleslim.prune.prune_io module<a class="headerlink" href="#module-paddleslim.prune.prune_io" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="paddleslim.prune.prune_io.save_model">
<code class="descclassname">paddleslim.prune.prune_io.</code><code class="descname">save_model</code><span class="sig-paren">(</span><em>exe</em>, <em>graph</em>, <em>dirname</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.prune_io.save_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Save weights of model and information of shapes into filesystem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>exe</strong> (<em>paddle.fluid.Executor</em>) &#8211; The executor used to save model.</li>
<li><strong>graph</strong> (<em>Program|Graph</em>) &#8211; The graph to be saved.</li>
<li><strong>dirname</strong> (<em>str</em>) &#8211; The directory that the model saved into.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.prune_io.load_model">
<code class="descclassname">paddleslim.prune.prune_io.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>exe</em>, <em>graph</em>, <em>dirname</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.prune_io.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load weights of model and information of shapes from filesystem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>graph</strong> (<em>Program|Graph</em>) &#8211; The graph to be updated by loaded information..</li>
<li><strong>dirname</strong> (<em>str</em>) &#8211; The directory that the model will be loaded.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-paddleslim.prune.prune_walker">
<span id="paddleslim-prune-prune-walker-module"></span><h2>paddleslim.prune.prune_walker module<a class="headerlink" href="#module-paddleslim.prune.prune_walker" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="paddleslim.prune.prune_walker.conv2d">
<em class="property">class </em><code class="descclassname">paddleslim.prune.prune_walker.</code><code class="descname">conv2d</code><span class="sig-paren">(</span><em>op</em>, <em>pruned_params</em>, <em>visited={}</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.prune_walker.conv2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">paddleslim.prune.prune_walker.PruneWorker</span></code></p>
</dd></dl>

</div>
<div class="section" id="module-paddleslim.prune.pruner">
<span id="paddleslim-prune-pruner-module"></span><h2>paddleslim.prune.pruner module<a class="headerlink" href="#module-paddleslim.prune.pruner" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="paddleslim.prune.pruner.Pruner">
<em class="property">class </em><code class="descclassname">paddleslim.prune.pruner.</code><code class="descname">Pruner</code><span class="sig-paren">(</span><em>criterion='l1_norm'</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.pruner.Pruner" title="Permalink to this definition">¶</a></dt>
<dd><p>The pruner used to prune channels of convolution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>criterion</strong> (<em>str</em>) &#8211; the criterion used to sort channels for pruning. It only supports &#8216;l1_norm&#8217; currently.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="paddleslim.prune.pruner.Pruner.prune">
<code class="descname">prune</code><span class="sig-paren">(</span><em>program</em>, <em>scope</em>, <em>params</em>, <em>ratios</em>, <em>place=None</em>, <em>lazy=False</em>, <em>only_graph=False</em>, <em>param_backup=False</em>, <em>param_shape_backup=False</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.pruner.Pruner.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Pruning the given parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>program</strong> (<em>fluid.Program</em>) &#8211; The program to be pruned.</li>
<li><strong>scope</strong> (<em>fluid.Scope</em>) &#8211; The scope storing paramaters to be pruned.</li>
<li><strong>params</strong> (<em>list&lt;str&gt;</em>) &#8211; A list of parameter names to be pruned.</li>
<li><strong>ratios</strong> (<em>list&lt;float&gt;</em>) &#8211; A list of ratios to be used to pruning parameters.</li>
<li><strong>place</strong> (<em>fluid.Place</em>) &#8211; The device place of filter parameters. Defalut: None.</li>
<li><strong>lazy</strong> (<em>bool</em>) &#8211; True means setting the pruned elements to zero.
False means cutting down the pruned elements. Default: False.</li>
<li><strong>only_graph</strong> (<em>bool</em>) &#8211; True means only modifying the graph.
False means modifying graph and variables in scope. Default: False.</li>
<li><strong>param_backup</strong> (<em>bool</em>) &#8211; Whether to return a dict to backup the values of parameters. Default: False.</li>
<li><strong>param_shape_backup</strong> (<em>bool</em>) &#8211; Whether to return a dict to backup the shapes of parameters. Default: False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">(pruned_program,</span> <span class="pre">param_backup,</span> <span class="pre">param_shape_backup)</span></code>. <code class="docutils literal"><span class="pre">pruned_program</span></code> is the pruned program. <code class="docutils literal"><span class="pre">param_backup</span></code> is a dict to backup the values of parameters. <code class="docutils literal"><span class="pre">param_shape_backup</span></code> is a dict to backup the shapes of parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-paddleslim.prune.sensitive">
<span id="paddleslim-prune-sensitive-module"></span><h2>paddleslim.prune.sensitive module<a class="headerlink" href="#module-paddleslim.prune.sensitive" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="paddleslim.prune.sensitive.sensitivity">
<code class="descclassname">paddleslim.prune.sensitive.</code><code class="descname">sensitivity</code><span class="sig-paren">(</span><em>program</em>, <em>place</em>, <em>param_names</em>, <em>eval_func</em>, <em>sensitivities_file=None</em>, <em>pruned_ratios=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive.sensitivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the sensitivities of convolutions in a model. The sensitivity of a convolution is the losses of accuracy on test dataset in differenct pruned ratios. The sensitivities can be used to get a group of best ratios with some condition.
This function return a dict storing sensitivities as below:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;weight_0&quot;</span><span class="p">:</span>
    <span class="p">{</span><span class="mf">0.1</span><span class="p">:</span> <span class="mf">0.22</span><span class="p">,</span>
     <span class="mf">0.2</span><span class="p">:</span> <span class="mf">0.33</span>
    <span class="p">},</span>
  <span class="s2">&quot;weight_1&quot;</span><span class="p">:</span>
    <span class="p">{</span><span class="mf">0.1</span><span class="p">:</span> <span class="mf">0.21</span><span class="p">,</span>
     <span class="mf">0.2</span><span class="p">:</span> <span class="mf">0.4</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">weight_0</span></code> is parameter name of convolution. <code class="docutils literal"><span class="pre">sensitivities['weight_0']</span></code> is a dict in which key is pruned ratio and value is the percent of losses.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>program</strong> (<em>paddle.fluid.Program</em>) &#8211; The program to be analysised.</li>
<li><strong>place</strong> (<em>fluid.CPUPlace | fluid.CUDAPlace</em>) &#8211; The device place of filter parameters.</li>
<li><strong>param_names</strong> (<em>list</em>) &#8211; The parameter names of convolutions to be analysised.</li>
<li><strong>eval_func</strong> (<em>function</em>) &#8211; The callback function used to evaluate the model. It should accept a instance of <cite>paddle.fluid.Program</cite> as argument and return a score on test dataset.</li>
<li><strong>sensitivities_file</strong> (<em>str</em>) &#8211; The file to save the sensitivities. It will append the latest computed sensitivities into the file. And the sensitivities in the file would not be computed again. This file can be loaded by <cite>pickle</cite> library.</li>
<li><strong>pruned_ratios</strong> (<em>list</em>) &#8211; The ratios to be pruned. default: <code class="docutils literal"><span class="pre">[0.1,</span> <span class="pre">0.2,</span> <span class="pre">0.3,</span> <span class="pre">0.4,</span> <span class="pre">0.5,</span> <span class="pre">0.6,</span> <span class="pre">0.7,</span> <span class="pre">0.8,</span> <span class="pre">0.9]</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A dict storing sensitivities.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.sensitive.flops_sensitivity">
<code class="descclassname">paddleslim.prune.sensitive.</code><code class="descname">flops_sensitivity</code><span class="sig-paren">(</span><em>program</em>, <em>place</em>, <em>param_names</em>, <em>eval_func</em>, <em>sensitivities_file=None</em>, <em>pruned_flops_rate=0.1</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive.flops_sensitivity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="paddleslim.prune.sensitive.load_sensitivities">
<code class="descclassname">paddleslim.prune.sensitive.</code><code class="descname">load_sensitivities</code><span class="sig-paren">(</span><em>sensitivities_file</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive.load_sensitivities" title="Permalink to this definition">¶</a></dt>
<dd><p>Load sensitivities from file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sensitivities_file</strong> (<em>str</em>) &#8211; The file storing sensitivities.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dict stroring sensitivities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.sensitive.merge_sensitive">
<code class="descclassname">paddleslim.prune.sensitive.</code><code class="descname">merge_sensitive</code><span class="sig-paren">(</span><em>sensitivities</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive.merge_sensitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge sensitivities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sensitivities</strong> (<em>list&lt;dict&gt; | list&lt;str&gt;</em>) &#8211; The sensitivities to be merged. It cann be a list of sensitivities files or dict.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A dict stroring sensitivities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="paddleslim.prune.sensitive.get_ratios_by_loss">
<code class="descclassname">paddleslim.prune.sensitive.</code><code class="descname">get_ratios_by_loss</code><span class="sig-paren">(</span><em>sensitivities</em>, <em>loss</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive.get_ratios_by_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the max ratio of each parameter. The loss of accuracy must be less than given <cite>loss</cite>
when the single parameter was pruned by the max ratio.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sensitivities</strong> (<em>dict</em>) &#8211; The sensitivities used to generate a group of pruning ratios. The key of dict
is name of parameters to be pruned. The value of dict is a list of tuple with
format <cite>(pruned_ratio, accuracy_loss)</cite>.</li>
<li><strong>loss</strong> (<em>float</em>) &#8211; The threshold of accuracy loss.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A group of ratios. The key of dict is name of parameters while the value is the ratio to be pruned.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-paddleslim.prune.sensitive_pruner">
<span id="paddleslim-prune-sensitive-pruner-module"></span><h2>paddleslim.prune.sensitive_pruner module<a class="headerlink" href="#module-paddleslim.prune.sensitive_pruner" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="paddleslim.prune.sensitive_pruner.SensitivePruner">
<em class="property">class </em><code class="descclassname">paddleslim.prune.sensitive_pruner.</code><code class="descname">SensitivePruner</code><span class="sig-paren">(</span><em>place</em>, <em>eval_func</em>, <em>scope=None</em>, <em>checkpoints=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive_pruner.SensitivePruner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Pruner used to prune parameters iteratively according to sensitivities
of parameters in each step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>place</strong> (<em>fluid.CUDAPlace | fluid.CPUPlace</em>) &#8211; The device place where
program execute.</li>
<li><strong>eval_func</strong> (<em>function</em>) &#8211; A callback function used to evaluate pruned
program. The argument of this function is pruned program.
And it return a score of given program.</li>
<li><strong>scope</strong> (<em>fluid.scope</em>) &#8211; The scope used to execute program.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="paddleslim.prune.sensitive_pruner.SensitivePruner.get_ratios_by_sensitive">
<code class="descname">get_ratios_by_sensitive</code><span class="sig-paren">(</span><em>sensitivities</em>, <em>pruned_flops</em>, <em>eval_program</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive_pruner.SensitivePruner.get_ratios_by_sensitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Search a group of ratios for pruning target flops.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sensitivities</strong> (<em>dict</em>) &#8211; The sensitivities used to generate a group of pruning ratios. The key of dict
is name of parameters to be pruned. The value of dict is a list of tuple with
format <cite>(pruned_ratio, accuracy_loss)</cite>.</li>
<li><strong>pruned_flops</strong> (<em>float</em>) &#8211; The percent of FLOPS to be pruned.</li>
<li><strong>eval_program</strong> (<em>Program</em>) &#8211; The program whose FLOPS is considered.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A group of ratios. The key of dict is name of parameters while the value is the ratio to be pruned.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="paddleslim.prune.sensitive_pruner.SensitivePruner.greedy_prune">
<code class="descname">greedy_prune</code><span class="sig-paren">(</span><em>train_program</em>, <em>eval_program</em>, <em>params</em>, <em>pruned_flops_rate</em>, <em>topk=1</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive_pruner.SensitivePruner.greedy_prune" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="paddleslim.prune.sensitive_pruner.SensitivePruner.prune">
<code class="descname">prune</code><span class="sig-paren">(</span><em>train_program</em>, <em>eval_program</em>, <em>params</em>, <em>pruned_flops</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive_pruner.SensitivePruner.prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Pruning parameters of training and evaluation network by sensitivities in current step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>train_program</strong> (<em>fluid.Program</em>) &#8211; The training program to be pruned.</li>
<li><strong>eval_program</strong> (<em>fluid.Program</em>) &#8211; The evaluation program to be pruned. And it is also used to calculate sensitivities of parameters.</li>
<li><strong>params</strong> (<em>list&lt;str&gt;</em>) &#8211; The parameters to be pruned.</li>
<li><strong>pruned_flops</strong> (<em>float</em>) &#8211; The ratio of FLOPS to be pruned in current step.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A tuple of pruned training program and pruned evaluation program.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="paddleslim.prune.sensitive_pruner.SensitivePruner.restore">
<code class="descname">restore</code><span class="sig-paren">(</span><em>checkpoints=None</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive_pruner.SensitivePruner.restore" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="paddleslim.prune.sensitive_pruner.SensitivePruner.save_checkpoint">
<code class="descname">save_checkpoint</code><span class="sig-paren">(</span><em>train_program</em>, <em>eval_program</em><span class="sig-paren">)</span><a class="headerlink" href="#paddleslim.prune.sensitive_pruner.SensitivePruner.save_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="paddleslim.dist.html" class="btn btn-neutral float-right" title="paddleslim.dist package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="paddleslim.analysis.html" class="btn btn-neutral" title="paddleslim.analysis package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, paddleslim.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>